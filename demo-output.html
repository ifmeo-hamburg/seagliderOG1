

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>seagliderOG1 demo &mdash; seagliderOG1 v0.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=8b92e751"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="seagliderOG1 API" href="seagliderOG1.html" />
    <link rel="prev" title="Welcome to seagliderOG1’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            seagliderOG1
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">seagliderOG1 demo</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Reading-basestation-files">Reading basestation files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Load-single-sample-dataset">Load single sample dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Load-datasets-from-a-local-directory">Load datasets from a local directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Load-datasets-from-a-remote-directory-(URL)">Load datasets from a remote directory (URL)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Convert-to-OG1-format">Convert to OG1 format</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Convert-a-single-(sample)-dataset">Convert a single (sample) dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Convert-mission-from-a-local-directory-of-basestation-files">Convert mission from a local directory of basestation files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Convert-mission-from-the-NCEI-server-(with-p*nc-files)">Convert mission from the NCEI server (with p*nc files)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Saving-data">Saving data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Run-multiple-missions">Run multiple missions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="seagliderOG1.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">seagliderOG1</span> <span class="pre">API</span></code></a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">seagliderOG1</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">seagliderOG1 demo</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/demo-output.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="seagliderOG1-demo">
<h1>seagliderOG1 demo<a class="headerlink" href="#seagliderOG1-demo" title="Link to this heading"></a></h1>
<p>The purpose of this notebook is to demonstrate the functionality of <code class="docutils literal notranslate"><span class="pre">seagliderOG1</span></code> to convert from Seaglider basestation files to OG1 format.</p>
<ul class="simple">
<li><p>OG1 format is a newly agreed format (since June 2024) for glider data sets from various platforms (e.g., Seaglider, Slocum, Seaexplorer). It lives on github here: (<a class="reference external" href="https://github.com/OceanGlidersCommunity/OG-format-user-manual">https://github.com/OceanGlidersCommunity/OG-format-user-manual</a>).</p></li>
<li><p>OG1 manual: <a class="reference external" href="https://oceangliderscommunity.github.io/OG-format-user-manual/OG_Format.html">https://oceangliderscommunity.github.io/OG-format-user-manual/OG_Format.html</a></p></li>
</ul>
<p>The test case is to convert sg015 data from the Labrador Sea in September 2004.</p>
<p>The demo is organised to show</p>
<ul class="simple">
<li><p>Conversion of a single dive cycle (single <code class="docutils literal notranslate"><span class="pre">p*.nc</span></code> file)</p></li>
<li><p>Conversion for a folder of local dive-cycle files (full mission of <code class="docutils literal notranslate"><span class="pre">p*.nc</span></code> files)</p></li>
<li><p>Download from remote server + conversion (directory with full mission of <code class="docutils literal notranslate"><span class="pre">p*.nc</span></code> files)</p></li>
</ul>
<p>Options are provided to only load e.g. 10 files, but note that OG1 format expects a full mission.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="n">script_dir</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
<span class="n">parent_dir</span> <span class="o">=</span> <span class="n">script_dir</span><span class="o">.</span><span class="n">parents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">parent_dir</span><span class="p">))</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">parent_dir</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/seagliderOG1&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">parent_dir</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pooch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">seagliderOG1</span><span class="w"> </span><span class="kn">import</span> <span class="n">readers</span><span class="p">,</span> <span class="n">writers</span><span class="p">,</span> <span class="n">plotters</span><span class="p">,</span> <span class="n">tools</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">seagliderOG1</span><span class="w"> </span><span class="kn">import</span> <span class="n">convertOG1</span><span class="p">,</span> <span class="n">vocabularies</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/home/runner/work/seagliderOG1/seagliderOG1
[&#39;/home/runner/micromamba/envs/TEST/lib/python312.zip&#39;, &#39;/home/runner/micromamba/envs/TEST/lib/python3.12&#39;, &#39;/home/runner/micromamba/envs/TEST/lib/python3.12/lib-dynload&#39;, &#39;&#39;, &#39;/home/runner/micromamba/envs/TEST/lib/python3.12/site-packages&#39;, &#39;/home/runner/work/seagliderOG1/seagliderOG1&#39;, &#39;/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1&#39;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:472: SyntaxWarning: invalid escape sequence &#39;\d&#39;
  fill_val = 2 ** (int(re.findall(&#34;\d+&#34;, str(new_dtype))[0]) - 1) - 1
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify the path for writing datafiles</span>
<span class="n">data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parent_dir</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Reading-basestation-files">
<h2>Reading basestation files<a class="headerlink" href="#Reading-basestation-files" title="Link to this heading"></a></h2>
<p>This has three ways to load a glider dataset.</p>
<p>Load an example dataset using <code class="docutils literal notranslate"><span class="pre">seagliderOG1.fetchers.load_sample_dataset</span></code></p>
<p>Alternatively, use your own with e.g. <code class="docutils literal notranslate"><span class="pre">ds</span> <span class="pre">=</span> <span class="pre">xr.open_dataset('/path/to/yourfile.nc')</span></code></p>
<section id="Load-single-sample-dataset">
<h3>Load single sample dataset<a class="headerlink" href="#Load-single-sample-dataset" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">readers</span><span class="o">.</span><span class="n">load_sample_dataset</span><span class="p">()</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Downloading file &#39;p0040034_20031007.nc&#39; from &#39;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/015/20040924/p0040034_20031007.nc&#39; to &#39;/home/runner/.cache/seagliderOG1&#39;.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">HTTPError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[3], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> ds <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">readers</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">load_sample_dataset</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> ds

File <span class="ansi-green-fg">~/work/seagliderOG1/seagliderOG1/seagliderOG1/readers.py:37</span>, in <span class="ansi-cyan-fg">load_sample_dataset</span><span class="ansi-blue-fg">(dataset_name)</span>
<span class="ansi-green-intense-fg ansi-bold">     35</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span><span style="color: rgb(188,188,188)"> </span><span style="color: rgb(0,0,255)">load_sample_dataset</span>(dataset_name<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">p0040034_20031007.nc</span><span style="color: rgb(175,0,0)">&#34;</span>):
<span class="ansi-green-intense-fg ansi-bold">     36</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> dataset_name <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> data_source_og<span style="color: rgb(98,98,98)">.</span>registry<span style="color: rgb(98,98,98)">.</span>keys():
<span class="ansi-green-fg">---&gt; 37</span>         file_path <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">data_source_og</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fetch</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">dataset_name</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     38</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> xr<span style="color: rgb(98,98,98)">.</span>open_dataset(file_path)
<span class="ansi-green-intense-fg ansi-bold">     39</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:

File <span class="ansi-green-fg">~/micromamba/envs/TEST/lib/python3.12/site-packages/pooch/core.py:589</span>, in <span class="ansi-cyan-fg">Pooch.fetch</span><span class="ansi-blue-fg">(self, fname, processor, downloader, progressbar)</span>
<span class="ansi-green-intense-fg ansi-bold">    586</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> downloader <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">    587</span>         downloader <span style="color: rgb(98,98,98)">=</span> choose_downloader(url, progressbar<span style="color: rgb(98,98,98)">=</span>progressbar)
<span class="ansi-green-fg">--&gt; 589</span>     <span class="ansi-yellow-bg">stream_download</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    590</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">url</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    591</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">full_path</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    592</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">known_hash</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    593</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">downloader</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    594</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">pooch</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    595</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">retry_if_failed</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">retry_if_failed</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    596</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    598</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> processor <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">    599</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> processor(<span style="color: rgb(0,135,0)">str</span>(full_path), action, <span style="color: rgb(0,135,0)">self</span>)

File <span class="ansi-green-fg">~/micromamba/envs/TEST/lib/python3.12/site-packages/pooch/core.py:807</span>, in <span class="ansi-cyan-fg">stream_download</span><span class="ansi-blue-fg">(url, fname, known_hash, downloader, pooch, retry_if_failed)</span>
<span class="ansi-green-intense-fg ansi-bold">    803</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-intense-fg ansi-bold">    804</span>     <span style="color: rgb(95,135,135)"># Stream the file to a temporary so that we can safely check its</span>
<span class="ansi-green-intense-fg ansi-bold">    805</span>     <span style="color: rgb(95,135,135)"># hash before overwriting the original.</span>
<span class="ansi-green-intense-fg ansi-bold">    806</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> temporary_file(path<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(0,135,0)">str</span>(fname<span style="color: rgb(98,98,98)">.</span>parent)) <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> tmp:
<span class="ansi-green-fg">--&gt; 807</span>         <span class="ansi-yellow-bg">downloader</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">url</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">tmp</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">pooch</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    808</span>         hash_matches(tmp, known_hash, strict<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">True</span>, source<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(0,135,0)">str</span>(fname<span style="color: rgb(98,98,98)">.</span>name))
<span class="ansi-green-intense-fg ansi-bold">    809</span>         shutil<span style="color: rgb(98,98,98)">.</span>move(tmp, <span style="color: rgb(0,135,0)">str</span>(fname))

File <span class="ansi-green-fg">~/micromamba/envs/TEST/lib/python3.12/site-packages/pooch/downloaders.py:221</span>, in <span class="ansi-cyan-fg">HTTPDownloader.__call__</span><span class="ansi-blue-fg">(self, url, output_file, pooch, check_only)</span>
<span class="ansi-green-intense-fg ansi-bold">    219</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-intense-fg ansi-bold">    220</span>     response <span style="color: rgb(98,98,98)">=</span> requests<span style="color: rgb(98,98,98)">.</span>get(url, timeout<span style="color: rgb(98,98,98)">=</span>timeout, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs)
<span class="ansi-green-fg">--&gt; 221</span>     <span class="ansi-yellow-bg">response</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">raise_for_status</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    222</span>     content <span style="color: rgb(98,98,98)">=</span> response<span style="color: rgb(98,98,98)">.</span>iter_content(chunk_size<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>chunk_size)
<span class="ansi-green-intense-fg ansi-bold">    223</span>     total <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">int</span>(response<span style="color: rgb(98,98,98)">.</span>headers<span style="color: rgb(98,98,98)">.</span>get(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">content-length</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(98,98,98)">0</span>))

File <span class="ansi-green-fg">~/micromamba/envs/TEST/lib/python3.12/site-packages/requests/models.py:1024</span>, in <span class="ansi-cyan-fg">Response.raise_for_status</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">   1019</span>     http_error_msg <span style="color: rgb(98,98,98)">=</span> (
<span class="ansi-green-intense-fg ansi-bold">   1020</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>status_code<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> Server Error: </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>reason<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> for url: </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>url<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   1021</span>     )
<span class="ansi-green-intense-fg ansi-bold">   1023</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> http_error_msg:
<span class="ansi-green-fg">-&gt; 1024</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> HTTPError(http_error_msg, response<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(0,135,0)">self</span>)

<span class="ansi-red-fg">HTTPError</span>: 404 Client Error: Not Found for url: https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/015/20040924/p0040034_20031007.nc
</pre></div></div>
</div>
</section>
<section id="Load-datasets-from-a-local-directory">
<h3>Load datasets from a local directory<a class="headerlink" href="#Load-datasets-from-a-local-directory" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify the input directory on your local machine</span>
<span class="n">input_dir</span> <span class="o">=</span> <span class="s2">&quot;/Users/eddifying/Dropbox/data/sg015-ncei-download&quot;</span>

<span class="c1"># Load and concatenate all datasets in the input directory</span>
<span class="c1"># Optionally, specify the range of profiles to load (start_profile, end_profile)</span>
<span class="n">list_datasets</span> <span class="o">=</span> <span class="n">readers</span><span class="o">.</span><span class="n">read_basestation</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">start_profile</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">end_profile</span><span class="o">=</span><span class="mi">503</span><span class="p">)</span>

<span class="c1"># Where list_datasets is a list of xarray datasets.  A single dataset can be accessed as</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">list_datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[4], line 6</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> input_dir <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">/Users/eddifying/Dropbox/data/sg015-ncei-download</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span style="color: rgb(95,135,135)"># Load and concatenate all datasets in the input directory</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> <span style="color: rgb(95,135,135)"># Optionally, specify the range of profiles to load (start_profile, end_profile)</span>
<span class="ansi-green-fg">----&gt; 6</span> list_datasets <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">readers</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">read_basestation</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">input_dir</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">start_profile</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">500</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">end_profile</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">503</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      8</span> <span style="color: rgb(95,135,135)"># Where list_datasets is a list of xarray datasets.  A single dataset can be accessed as</span>
<span class="ansi-green-intense-fg ansi-bold">      9</span> ds <span style="color: rgb(98,98,98)">=</span> list_datasets[<span style="color: rgb(98,98,98)">0</span>]

File <span class="ansi-green-fg">~/work/seagliderOG1/seagliderOG1/seagliderOG1/readers.py:101</span>, in <span class="ansi-cyan-fg">read_basestation</span><span class="ansi-blue-fg">(source, start_profile, end_profile)</span>
<span class="ansi-green-intense-fg ansi-bold">     99</span>     file_list <span style="color: rgb(98,98,98)">=</span> os<span style="color: rgb(98,98,98)">.</span>listdir(source)
<span class="ansi-green-intense-fg ansi-bold">    100</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 101</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">ValueError</span>(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Source must be a valid URL or directory path.</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-intense-fg ansi-bold">    103</span> filtered_files <span style="color: rgb(98,98,98)">=</span> filter_files_by_profile(file_list, start_profile, end_profile)
<span class="ansi-green-intense-fg ansi-bold">    105</span> datasets <span style="color: rgb(98,98,98)">=</span> []

<span class="ansi-red-fg">ValueError</span>: Source must be a valid URL or directory path.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[5], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">ds</span>

<span class="ansi-red-fg">NameError</span>: name &#39;ds&#39; is not defined
</pre></div></div>
</div>
</section>
<section id="Load-datasets-from-a-remote-directory-(URL)">
<h3>Load datasets from a remote directory (URL)<a class="headerlink" href="#Load-datasets-from-a-remote-directory-(URL)" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify the server where data are located</span>
<span class="n">server</span> <span class="o">=</span> <span class="s2">&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/015/20040924/&quot;</span>

<span class="c1"># Load and concatenate all datasets from the server, optionally specifying the range of profiles to load</span>
<span class="n">list_datasets</span> <span class="o">=</span> <span class="n">readers</span><span class="o">.</span><span class="n">read_basestation</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">start_profile</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">end_profile</span><span class="o">=</span><span class="mi">503</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Downloading file &#39;p0150500_20050213.nc&#39; from &#39;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/015/20040924/p0150500_20050213.nc&#39; to &#39;/home/runner/.cache/seagliderOG1&#39;.
Downloading file &#39;p0150501_20050213.nc&#39; from &#39;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/015/20040924/p0150501_20050213.nc&#39; to &#39;/home/runner/.cache/seagliderOG1&#39;.
Downloading file &#39;p0150502_20050214.nc&#39; from &#39;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/015/20040924/p0150502_20050214.nc&#39; to &#39;/home/runner/.cache/seagliderOG1&#39;.
Downloading file &#39;p0150503_20050214.nc&#39; from &#39;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/015/20040924/p0150503_20050214.nc&#39; to &#39;/home/runner/.cache/seagliderOG1&#39;.
</pre></div></div>
</div>
</section>
</section>
<section id="Convert-to-OG1-format">
<h2>Convert to OG1 format<a class="headerlink" href="#Convert-to-OG1-format" title="Link to this heading"></a></h2>
<p>Process:</p>
<ol class="arabic simple">
<li><p>For one basestation dataset, split the dataset by dimension (<code class="docutils literal notranslate"><span class="pre">split_ds</span></code>)</p></li>
<li><p>Transform into OG1 format: dataset with dims <code class="docutils literal notranslate"><span class="pre">sg_data_point</span></code></p>
<ul class="simple">
<li><p>Change the dimension to <code class="docutils literal notranslate"><span class="pre">N_MEASUREMENTS</span></code></p></li>
<li><p>Rename variables according to <code class="docutils literal notranslate"><span class="pre">vocabularies.standard_names</span></code></p></li>
<li><p>Assign variable attributes according to <code class="docutils literal notranslate"><span class="pre">vocabularies.vocab_attrs</span></code>. (Note: This <em>could</em> go wrong since it makes assumptions about the input variables. May need additional handling.)</p></li>
</ul>
</li>
<li><p>Add missing mandatory variables:</p>
<ul class="simple">
<li><p>From <code class="docutils literal notranslate"><span class="pre">split_ds[(gps_info,)]</span></code>, add the <code class="docutils literal notranslate"><span class="pre">LATITUDE_GPS</span></code>, <code class="docutils literal notranslate"><span class="pre">LONGITUDE_GPS</span></code> and <code class="docutils literal notranslate"><span class="pre">TIME_GPS</span></code> (Note: presently <code class="docutils literal notranslate"><span class="pre">TIME_GPS</span></code> is stripped before saving, but <code class="docutils literal notranslate"><span class="pre">TIME</span></code> values contain <code class="docutils literal notranslate"><span class="pre">TIME_GPS</span></code>)</p></li>
<li><p>Create <code class="docutils literal notranslate"><span class="pre">PROFILE_NUMBER</span></code> and <code class="docutils literal notranslate"><span class="pre">PHASE</span></code></p></li>
<li><p>Calculate <code class="docutils literal notranslate"><span class="pre">DEPTH_Z</span></code> which is positive up</p></li>
</ul>
</li>
<li><p>Update attributes for the file.</p>
<ul class="simple">
<li><p>Combines <code class="docutils literal notranslate"><span class="pre">creator</span></code> and <code class="docutils literal notranslate"><span class="pre">contributor</span></code> from original attributes into <code class="docutils literal notranslate"><span class="pre">contributor</span></code></p></li>
<li><p>Adds <code class="docutils literal notranslate"><span class="pre">contributing_institutions</span></code> based on <code class="docutils literal notranslate"><span class="pre">institution</span></code></p></li>
<li><p>Reformats time in <code class="docutils literal notranslate"><span class="pre">time_coverage_*</span></code> and <code class="docutils literal notranslate"><span class="pre">start_time</span></code>–&gt; <code class="docutils literal notranslate"><span class="pre">start_date</span></code></p></li>
<li><p>Adds <code class="docutils literal notranslate"><span class="pre">date_modified</span></code></p></li>
<li><p>Renames <code class="docutils literal notranslate"><span class="pre">comments</span></code>–&gt;<code class="docutils literal notranslate"><span class="pre">history</span></code>, <code class="docutils literal notranslate"><span class="pre">site</span></code>–&gt;<code class="docutils literal notranslate"><span class="pre">summary</span></code></p></li>
<li><p>Adds <code class="docutils literal notranslate"><span class="pre">title</span></code>, <code class="docutils literal notranslate"><span class="pre">platform</span></code>, <code class="docutils literal notranslate"><span class="pre">platform_vocabulary</span></code>, <code class="docutils literal notranslate"><span class="pre">featureType</span></code>, <code class="docutils literal notranslate"><span class="pre">Conventions</span></code>, <code class="docutils literal notranslate"><span class="pre">rtqc_method*</span></code> according to OceanGliders format</p></li>
<li><p>Retains <code class="docutils literal notranslate"><span class="pre">naming_authority</span></code>, <code class="docutils literal notranslate"><span class="pre">institution</span></code>, <code class="docutils literal notranslate"><span class="pre">project</span></code>, <code class="docutils literal notranslate"><span class="pre">geospatial_*</span></code> as OG attributes</p></li>
<li><p>Retains extra attributes: <code class="docutils literal notranslate"><span class="pre">license</span></code>, <code class="docutils literal notranslate"><span class="pre">keywords</span></code>, <code class="docutils literal notranslate"><span class="pre">keywords_vocabulary</span></code>, <code class="docutils literal notranslate"><span class="pre">file_version</span></code>, <code class="docutils literal notranslate"><span class="pre">acknowledgement</span></code>, <code class="docutils literal notranslate"><span class="pre">date_created</span></code>, <code class="docutils literal notranslate"><span class="pre">disclaimer</span></code></p></li>
</ul>
</li>
</ol>
<p>Future behaviour to be added:</p>
<ol class="arabic simple" start="6">
<li><p>Retain the variables starting with <code class="docutils literal notranslate"><span class="pre">sg_cal</span></code> and check whether they vary over the mission (shouldn’t)</p></li>
<li><p>Add sensors, using information in the <code class="docutils literal notranslate"><span class="pre">split_ds</span></code> with no dimensions</p>
<ul class="simple">
<li><p>Need (from sg_cal_constants: <code class="docutils literal notranslate"><span class="pre">sg_cal</span></code> plus <code class="docutils literal notranslate"><span class="pre">volmax</span></code>, <code class="docutils literal notranslate"><span class="pre">vbd_cnts_per_cc</span></code>, <code class="docutils literal notranslate"><span class="pre">therm_expan</span></code>, <code class="docutils literal notranslate"><span class="pre">t_*</span></code>, <code class="docutils literal notranslate"><span class="pre">mass</span></code>, <code class="docutils literal notranslate"><span class="pre">hd_*</span></code>, <code class="docutils literal notranslate"><span class="pre">ctcor</span></code>, <code class="docutils literal notranslate"><span class="pre">cpcor</span></code>, <code class="docutils literal notranslate"><span class="pre">c_*</span></code>, <code class="docutils literal notranslate"><span class="pre">abs_compress</span></code>, <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">Tcor</span></code>, <code class="docutils literal notranslate"><span class="pre">Soc</span></code>, <code class="docutils literal notranslate"><span class="pre">Pcor</span></code>, <code class="docutils literal notranslate"><span class="pre">Foffset</span></code>)</p></li>
<li><p>Maybe also <code class="docutils literal notranslate"><span class="pre">reviewed</span></code>, <code class="docutils literal notranslate"><span class="pre">magnetic_variation</span></code> (which will change with position), <code class="docutils literal notranslate"><span class="pre">log_D_FLARE</span></code>, <code class="docutils literal notranslate"><span class="pre">flight_avg_speed_north</span></code> and <code class="docutils literal notranslate"><span class="pre">flight_avg_speed_east</span></code> also with <code class="docutils literal notranslate"><span class="pre">_gsm</span></code>, <code class="docutils literal notranslate"><span class="pre">depth_avg_curr_north</span></code> and <code class="docutils literal notranslate"><span class="pre">depth_avg_curr_east</span></code> also with <code class="docutils literal notranslate"><span class="pre">_gsm</span></code>, <code class="docutils literal notranslate"><span class="pre">wlbb2f</span></code> - means sensor <code class="docutils literal notranslate"><span class="pre">sg_cal_mission_title</span></code> <code class="docutils literal notranslate"><span class="pre">sg_cal_id_str</span></code> <code class="docutils literal notranslate"><span class="pre">calibcomm_oxygen</span></code> <code class="docutils literal notranslate"><span class="pre">calibcomm</span></code> <code class="docutils literal notranslate"><span class="pre">sbe41</span></code> means ?? <code class="docutils literal notranslate"><span class="pre">hdm_qc</span></code> <code class="docutils literal notranslate"><span class="pre">glider</span></code></p></li>
</ul>
</li>
</ol>
<section id="Convert-a-single-(sample)-dataset">
<h3>Convert a single (sample) dataset<a class="headerlink" href="#Convert-a-single-(sample)-dataset" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loads one dataset (p0150500_20050213.nc)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">readers</span><span class="o">.</span><span class="n">load_sample_dataset</span><span class="p">()</span>

<span class="n">ds_OG1</span> <span class="o">=</span> <span class="n">convertOG1</span><span class="o">.</span><span class="n">convert_to_OG1</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>

<span class="c1"># Check the results - uncomment the following lines to either generate a plot or show the variables.</span>
<span class="n">plotters</span><span class="o">.</span><span class="n">plot_profile_depth</span><span class="p">(</span><span class="n">ds_OG1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Downloading file &#39;p0040034_20031007.nc&#39; from &#39;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/015/20040924/p0040034_20031007.nc&#39; to &#39;/home/runner/.cache/seagliderOG1&#39;.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">HTTPError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[7], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span style="color: rgb(95,135,135)"># Loads one dataset (p0150500_20050213.nc)</span>
<span class="ansi-green-fg">----&gt; 2</span> ds <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">readers</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">load_sample_dataset</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> ds_OG1 <span style="color: rgb(98,98,98)">=</span> convertOG1<span style="color: rgb(98,98,98)">.</span>convert_to_OG1(ds)
<span class="ansi-green-intense-fg ansi-bold">      6</span> <span style="color: rgb(95,135,135)"># Check the results - uncomment the following lines to either generate a plot or show the variables.</span>

File <span class="ansi-green-fg">~/work/seagliderOG1/seagliderOG1/seagliderOG1/readers.py:37</span>, in <span class="ansi-cyan-fg">load_sample_dataset</span><span class="ansi-blue-fg">(dataset_name)</span>
<span class="ansi-green-intense-fg ansi-bold">     35</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span><span style="color: rgb(188,188,188)"> </span><span style="color: rgb(0,0,255)">load_sample_dataset</span>(dataset_name<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">p0040034_20031007.nc</span><span style="color: rgb(175,0,0)">&#34;</span>):
<span class="ansi-green-intense-fg ansi-bold">     36</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> dataset_name <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> data_source_og<span style="color: rgb(98,98,98)">.</span>registry<span style="color: rgb(98,98,98)">.</span>keys():
<span class="ansi-green-fg">---&gt; 37</span>         file_path <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">data_source_og</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fetch</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">dataset_name</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     38</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> xr<span style="color: rgb(98,98,98)">.</span>open_dataset(file_path)
<span class="ansi-green-intense-fg ansi-bold">     39</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:

File <span class="ansi-green-fg">~/micromamba/envs/TEST/lib/python3.12/site-packages/pooch/core.py:589</span>, in <span class="ansi-cyan-fg">Pooch.fetch</span><span class="ansi-blue-fg">(self, fname, processor, downloader, progressbar)</span>
<span class="ansi-green-intense-fg ansi-bold">    586</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> downloader <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">    587</span>         downloader <span style="color: rgb(98,98,98)">=</span> choose_downloader(url, progressbar<span style="color: rgb(98,98,98)">=</span>progressbar)
<span class="ansi-green-fg">--&gt; 589</span>     <span class="ansi-yellow-bg">stream_download</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    590</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">url</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    591</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">full_path</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    592</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">known_hash</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    593</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">downloader</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    594</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">pooch</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    595</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">retry_if_failed</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">retry_if_failed</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    596</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    598</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> processor <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">    599</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> processor(<span style="color: rgb(0,135,0)">str</span>(full_path), action, <span style="color: rgb(0,135,0)">self</span>)

File <span class="ansi-green-fg">~/micromamba/envs/TEST/lib/python3.12/site-packages/pooch/core.py:807</span>, in <span class="ansi-cyan-fg">stream_download</span><span class="ansi-blue-fg">(url, fname, known_hash, downloader, pooch, retry_if_failed)</span>
<span class="ansi-green-intense-fg ansi-bold">    803</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-intense-fg ansi-bold">    804</span>     <span style="color: rgb(95,135,135)"># Stream the file to a temporary so that we can safely check its</span>
<span class="ansi-green-intense-fg ansi-bold">    805</span>     <span style="color: rgb(95,135,135)"># hash before overwriting the original.</span>
<span class="ansi-green-intense-fg ansi-bold">    806</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> temporary_file(path<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(0,135,0)">str</span>(fname<span style="color: rgb(98,98,98)">.</span>parent)) <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> tmp:
<span class="ansi-green-fg">--&gt; 807</span>         <span class="ansi-yellow-bg">downloader</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">url</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">tmp</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">pooch</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    808</span>         hash_matches(tmp, known_hash, strict<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">True</span>, source<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(0,135,0)">str</span>(fname<span style="color: rgb(98,98,98)">.</span>name))
<span class="ansi-green-intense-fg ansi-bold">    809</span>         shutil<span style="color: rgb(98,98,98)">.</span>move(tmp, <span style="color: rgb(0,135,0)">str</span>(fname))

File <span class="ansi-green-fg">~/micromamba/envs/TEST/lib/python3.12/site-packages/pooch/downloaders.py:221</span>, in <span class="ansi-cyan-fg">HTTPDownloader.__call__</span><span class="ansi-blue-fg">(self, url, output_file, pooch, check_only)</span>
<span class="ansi-green-intense-fg ansi-bold">    219</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-intense-fg ansi-bold">    220</span>     response <span style="color: rgb(98,98,98)">=</span> requests<span style="color: rgb(98,98,98)">.</span>get(url, timeout<span style="color: rgb(98,98,98)">=</span>timeout, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs)
<span class="ansi-green-fg">--&gt; 221</span>     <span class="ansi-yellow-bg">response</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">raise_for_status</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    222</span>     content <span style="color: rgb(98,98,98)">=</span> response<span style="color: rgb(98,98,98)">.</span>iter_content(chunk_size<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>chunk_size)
<span class="ansi-green-intense-fg ansi-bold">    223</span>     total <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">int</span>(response<span style="color: rgb(98,98,98)">.</span>headers<span style="color: rgb(98,98,98)">.</span>get(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">content-length</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(98,98,98)">0</span>))

File <span class="ansi-green-fg">~/micromamba/envs/TEST/lib/python3.12/site-packages/requests/models.py:1024</span>, in <span class="ansi-cyan-fg">Response.raise_for_status</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">   1019</span>     http_error_msg <span style="color: rgb(98,98,98)">=</span> (
<span class="ansi-green-intense-fg ansi-bold">   1020</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>status_code<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> Server Error: </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>reason<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> for url: </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>url<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   1021</span>     )
<span class="ansi-green-intense-fg ansi-bold">   1023</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> http_error_msg:
<span class="ansi-green-fg">-&gt; 1024</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> HTTPError(http_error_msg, response<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(0,135,0)">self</span>)

<span class="ansi-red-fg">HTTPError</span>: 404 Client Error: Not Found for url: https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/015/20040924/p0040034_20031007.nc
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print to screen a table of the variables and variable attributes</span>
<span class="c1">#plotters.show_attributes(ds_OG1)</span>
<span class="n">ds_OG1</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[8], line 3</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span style="color: rgb(95,135,135)"># Print to screen a table of the variables and variable attributes</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(95,135,135)">#plotters.show_attributes(ds_OG1)</span>
<span class="ansi-green-fg">----&gt; 3</span> <span class="ansi-yellow-bg">ds_OG1</span>

<span class="ansi-red-fg">NameError</span>: name &#39;ds_OG1&#39; is not defined
</pre></div></div>
</div>
</section>
<section id="Convert-mission-from-a-local-directory-of-basestation-files">
<h3>Convert mission from a local directory of basestation files<a class="headerlink" href="#Convert-mission-from-a-local-directory-of-basestation-files" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>For local data in the directory <code class="docutils literal notranslate"><span class="pre">input_dir</span></code></p></li>
<li><p>Creates a plot of ctd_depth against ctd_time.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify the input directory on your local machine</span>
<span class="n">input_dir</span> <span class="o">=</span> <span class="s2">&quot;/Users/eddifying/Dropbox/data/sg015-ncei-download&quot;</span>

<span class="c1"># Load and concatenate all datasets in the input directory</span>
<span class="c1"># Optionally, specify the range of profiles to load (start_profile, end_profile)</span>
<span class="n">list_datasets</span> <span class="o">=</span> <span class="n">readers</span><span class="o">.</span><span class="n">read_basestation</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">start_profile</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">end_profile</span><span class="o">=</span><span class="mi">503</span><span class="p">)</span>

<span class="c1"># Convert the list of datasets to OG1</span>
<span class="n">ds_OG1</span> <span class="o">=</span> <span class="n">convertOG1</span><span class="o">.</span><span class="n">convert_to_OG1</span><span class="p">(</span><span class="n">list_datasets</span><span class="p">)</span>

<span class="c1"># Generate a simple plot</span>
<span class="n">plotters</span><span class="o">.</span><span class="n">plot_profile_depth</span><span class="p">(</span><span class="n">ds_OG1</span><span class="p">)</span>
<span class="c1">#plotters.show_contents(ds_all,&#39;attrs&#39;)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[9], line 6</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> input_dir <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">/Users/eddifying/Dropbox/data/sg015-ncei-download</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span style="color: rgb(95,135,135)"># Load and concatenate all datasets in the input directory</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> <span style="color: rgb(95,135,135)"># Optionally, specify the range of profiles to load (start_profile, end_profile)</span>
<span class="ansi-green-fg">----&gt; 6</span> list_datasets <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">readers</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">read_basestation</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">input_dir</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">start_profile</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">500</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">end_profile</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">503</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      8</span> <span style="color: rgb(95,135,135)"># Convert the list of datasets to OG1</span>
<span class="ansi-green-intense-fg ansi-bold">      9</span> ds_OG1 <span style="color: rgb(98,98,98)">=</span> convertOG1<span style="color: rgb(98,98,98)">.</span>convert_to_OG1(list_datasets)

File <span class="ansi-green-fg">~/work/seagliderOG1/seagliderOG1/seagliderOG1/readers.py:101</span>, in <span class="ansi-cyan-fg">read_basestation</span><span class="ansi-blue-fg">(source, start_profile, end_profile)</span>
<span class="ansi-green-intense-fg ansi-bold">     99</span>     file_list <span style="color: rgb(98,98,98)">=</span> os<span style="color: rgb(98,98,98)">.</span>listdir(source)
<span class="ansi-green-intense-fg ansi-bold">    100</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 101</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">ValueError</span>(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Source must be a valid URL or directory path.</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-intense-fg ansi-bold">    103</span> filtered_files <span style="color: rgb(98,98,98)">=</span> filter_files_by_profile(file_list, start_profile, end_profile)
<span class="ansi-green-intense-fg ansi-bold">    105</span> datasets <span style="color: rgb(98,98,98)">=</span> []

<span class="ansi-red-fg">ValueError</span>: Source must be a valid URL or directory path.
</pre></div></div>
</div>
</section>
<section id="Convert-mission-from-the-NCEI-server-(with-p*nc-files)">
<h3>Convert mission from the NCEI server (with p*nc files)<a class="headerlink" href="#Convert-mission-from-the-NCEI-server-(with-p*nc-files)" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Data from the sg015 mission in the Labrador Sea (<a class="reference external" href="https://www.ncei.noaa.gov/access/metadata/landing-page/bin/iso?id=gov.noaa.nodc:0111844">https://www.ncei.noaa.gov/access/metadata/landing-page/bin/iso?id=gov.noaa.nodc:0111844</a>), dataset identifier gov.noaa.nodc:0111844.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify the server where data are located</span>
<span class="n">server</span> <span class="o">=</span> <span class="s2">&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/015/20040924/&quot;</span>

<span class="c1"># Load and concatenate all datasets from the server, optionally specifying the range of profiles to load</span>
<span class="n">list_datasets</span> <span class="o">=</span> <span class="n">readers</span><span class="o">.</span><span class="n">read_basestation</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">start_profile</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">end_profile</span><span class="o">=</span><span class="mi">503</span><span class="p">)</span>

<span class="c1"># Convert the list of datasets to OG1</span>
<span class="n">ds_OG1</span> <span class="o">=</span> <span class="n">convertOG1</span><span class="o">.</span><span class="n">convert_to_OG1</span><span class="p">(</span><span class="n">list_datasets</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Variable &#39;vert_speed_gsm&#39; not in OG1 vocabulary.
Variable &#39;time&#39; not in OG1 vocabulary.
Variable &#39;speed_gsm&#39; not in OG1 vocabulary.
Variable &#39;sound_velocity&#39; not in OG1 vocabulary.
Variable &#39;north_displacement_gsm&#39; not in OG1 vocabulary.
Variable &#39;longitude_gsm&#39; not in OG1 vocabulary.
Variable &#39;latitude_gsm&#39; not in OG1 vocabulary.
Variable &#39;horz_speed_gsm&#39; not in OG1 vocabulary.
Variable &#39;glide_angle_gsm&#39; not in OG1 vocabulary.
Variable &#39;eng_wlbb2f_VFtemp&#39; not in OG1 vocabulary.
Variable &#39;eng_sbect_tempFreq&#39; not in OG1 vocabulary.
Variable &#39;eng_sbect_condFreq&#39; not in OG1 vocabulary.
Variable &#39;eng_elaps_t_0000&#39; not in OG1 vocabulary.
Variable &#39;eng_elaps_t&#39; not in OG1 vocabulary.
Variable &#39;eng_depth&#39; not in OG1 vocabulary.
Variable &#39;east_displacement_gsm&#39; not in OG1 vocabulary.
Variable &#39;depth&#39; not in OG1 vocabulary.
Variable &#39;density&#39; not in OG1 vocabulary.
Variable &#39;buoyancy&#39; not in OG1 vocabulary.
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:359: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  return ds.assign(divenum=(&#39;N_MEASUREMENTS&#39;, [dive_number] * ds.dims[&#39;N_MEASUREMENTS&#39;]))
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:178: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  ds[&#39;dive_num_cast&#39;] = ([&#39;N_MEASUREMENTS&#39;], np.full(ds.dims[&#39;N_MEASUREMENTS&#39;], np.nan))
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:239: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  ds[&#39;PHASE&#39;] = ([&#39;N_MEASUREMENTS&#39;], np.full(ds.dims[&#39;N_MEASUREMENTS&#39;], np.nan))
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:241: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  ds[&#39;PHASE_QC&#39;] = ([&#39;N_MEASUREMENTS&#39;], np.zeros(ds.dims[&#39;N_MEASUREMENTS&#39;], dtype=int))
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:292: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  ds[&#39;DEPTH_Z&#39;] = ([&#39;N_MEASUREMENTS&#39;], np.full(ds.dims[&#39;N_MEASUREMENTS&#39;], np.nan))
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
No conversion information found for cm s-1 to degrees
No conversion information found for micromoles/kg to percent
wlbb2f
Adding sensor: SENSOR_FLUOROMETERS
sbe41
sbe41
SBE t12/c12 calibration 30DEC03
30DEC03
Unknown
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Variable &#39;vert_speed_gsm&#39; not in OG1 vocabulary.
Variable &#39;time&#39; not in OG1 vocabulary.
Variable &#39;speed_gsm&#39; not in OG1 vocabulary.
Variable &#39;sound_velocity&#39; not in OG1 vocabulary.
Variable &#39;north_displacement_gsm&#39; not in OG1 vocabulary.
Variable &#39;longitude_gsm&#39; not in OG1 vocabulary.
Variable &#39;latitude_gsm&#39; not in OG1 vocabulary.
Variable &#39;horz_speed_gsm&#39; not in OG1 vocabulary.
Variable &#39;glide_angle_gsm&#39; not in OG1 vocabulary.
Variable &#39;eng_wlbb2f_VFtemp&#39; not in OG1 vocabulary.
Variable &#39;eng_sbect_tempFreq&#39; not in OG1 vocabulary.
Variable &#39;eng_sbect_condFreq&#39; not in OG1 vocabulary.
Variable &#39;eng_elaps_t_0000&#39; not in OG1 vocabulary.
Variable &#39;eng_elaps_t&#39; not in OG1 vocabulary.
Variable &#39;eng_depth&#39; not in OG1 vocabulary.
Variable &#39;east_displacement_gsm&#39; not in OG1 vocabulary.
Variable &#39;depth&#39; not in OG1 vocabulary.
Variable &#39;density&#39; not in OG1 vocabulary.
Variable &#39;buoyancy&#39; not in OG1 vocabulary.
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:359: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  return ds.assign(divenum=(&#39;N_MEASUREMENTS&#39;, [dive_number] * ds.dims[&#39;N_MEASUREMENTS&#39;]))
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:178: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  ds[&#39;dive_num_cast&#39;] = ([&#39;N_MEASUREMENTS&#39;], np.full(ds.dims[&#39;N_MEASUREMENTS&#39;], np.nan))
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:239: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  ds[&#39;PHASE&#39;] = ([&#39;N_MEASUREMENTS&#39;], np.full(ds.dims[&#39;N_MEASUREMENTS&#39;], np.nan))
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:241: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  ds[&#39;PHASE_QC&#39;] = ([&#39;N_MEASUREMENTS&#39;], np.zeros(ds.dims[&#39;N_MEASUREMENTS&#39;], dtype=int))
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:292: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  ds[&#39;DEPTH_Z&#39;] = ([&#39;N_MEASUREMENTS&#39;], np.full(ds.dims[&#39;N_MEASUREMENTS&#39;], np.nan))
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
No conversion information found for cm s-1 to degrees
No conversion information found for micromoles/kg to percent
wlbb2f
Adding sensor: SENSOR_FLUOROMETERS
sbe41
sbe41
SBE t12/c12 calibration 30DEC03
30DEC03
Unknown
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Variable &#39;vert_speed_gsm&#39; not in OG1 vocabulary.
Variable &#39;time&#39; not in OG1 vocabulary.
Variable &#39;speed_gsm&#39; not in OG1 vocabulary.
Variable &#39;sound_velocity&#39; not in OG1 vocabulary.
Variable &#39;north_displacement_gsm&#39; not in OG1 vocabulary.
Variable &#39;longitude_gsm&#39; not in OG1 vocabulary.
Variable &#39;latitude_gsm&#39; not in OG1 vocabulary.
Variable &#39;horz_speed_gsm&#39; not in OG1 vocabulary.
Variable &#39;glide_angle_gsm&#39; not in OG1 vocabulary.
Variable &#39;eng_wlbb2f_VFtemp&#39; not in OG1 vocabulary.
Variable &#39;eng_sbect_tempFreq&#39; not in OG1 vocabulary.
Variable &#39;eng_sbect_condFreq&#39; not in OG1 vocabulary.
Variable &#39;eng_elaps_t_0000&#39; not in OG1 vocabulary.
Variable &#39;eng_elaps_t&#39; not in OG1 vocabulary.
Variable &#39;eng_depth&#39; not in OG1 vocabulary.
Variable &#39;east_displacement_gsm&#39; not in OG1 vocabulary.
Variable &#39;depth&#39; not in OG1 vocabulary.
Variable &#39;density&#39; not in OG1 vocabulary.
Variable &#39;buoyancy&#39; not in OG1 vocabulary.
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:359: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  return ds.assign(divenum=(&#39;N_MEASUREMENTS&#39;, [dive_number] * ds.dims[&#39;N_MEASUREMENTS&#39;]))
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:178: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  ds[&#39;dive_num_cast&#39;] = ([&#39;N_MEASUREMENTS&#39;], np.full(ds.dims[&#39;N_MEASUREMENTS&#39;], np.nan))
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:239: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  ds[&#39;PHASE&#39;] = ([&#39;N_MEASUREMENTS&#39;], np.full(ds.dims[&#39;N_MEASUREMENTS&#39;], np.nan))
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:241: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  ds[&#39;PHASE_QC&#39;] = ([&#39;N_MEASUREMENTS&#39;], np.zeros(ds.dims[&#39;N_MEASUREMENTS&#39;], dtype=int))
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:292: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  ds[&#39;DEPTH_Z&#39;] = ([&#39;N_MEASUREMENTS&#39;], np.full(ds.dims[&#39;N_MEASUREMENTS&#39;], np.nan))
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
No conversion information found for cm s-1 to degrees
No conversion information found for micromoles/kg to percent
wlbb2f
Adding sensor: SENSOR_FLUOROMETERS
sbe41
sbe41
SBE t12/c12 calibration 30DEC03
30DEC03
Unknown
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Variable &#39;vert_speed_gsm&#39; not in OG1 vocabulary.
Variable &#39;time&#39; not in OG1 vocabulary.
Variable &#39;speed_gsm&#39; not in OG1 vocabulary.
Variable &#39;sound_velocity&#39; not in OG1 vocabulary.
Variable &#39;north_displacement_gsm&#39; not in OG1 vocabulary.
Variable &#39;longitude_gsm&#39; not in OG1 vocabulary.
Variable &#39;latitude_gsm&#39; not in OG1 vocabulary.
Variable &#39;horz_speed_gsm&#39; not in OG1 vocabulary.
Variable &#39;glide_angle_gsm&#39; not in OG1 vocabulary.
Variable &#39;eng_wlbb2f_VFtemp&#39; not in OG1 vocabulary.
Variable &#39;eng_sbect_tempFreq&#39; not in OG1 vocabulary.
Variable &#39;eng_sbect_condFreq&#39; not in OG1 vocabulary.
Variable &#39;eng_elaps_t_0000&#39; not in OG1 vocabulary.
Variable &#39;eng_elaps_t&#39; not in OG1 vocabulary.
Variable &#39;eng_depth&#39; not in OG1 vocabulary.
Variable &#39;east_displacement_gsm&#39; not in OG1 vocabulary.
Variable &#39;depth&#39; not in OG1 vocabulary.
Variable &#39;density&#39; not in OG1 vocabulary.
Variable &#39;buoyancy&#39; not in OG1 vocabulary.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
No conversion information found for cm s-1 to degrees
No conversion information found for micromoles/kg to percent
wlbb2f
Adding sensor: SENSOR_FLUOROMETERS
sbe41
sbe41
SBE t12/c12 calibration 30DEC03
30DEC03
Unknown
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:359: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  return ds.assign(divenum=(&#39;N_MEASUREMENTS&#39;, [dive_number] * ds.dims[&#39;N_MEASUREMENTS&#39;]))
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:178: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  ds[&#39;dive_num_cast&#39;] = ([&#39;N_MEASUREMENTS&#39;], np.full(ds.dims[&#39;N_MEASUREMENTS&#39;], np.nan))
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:239: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  ds[&#39;PHASE&#39;] = ([&#39;N_MEASUREMENTS&#39;], np.full(ds.dims[&#39;N_MEASUREMENTS&#39;], np.nan))
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:241: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  ds[&#39;PHASE_QC&#39;] = ([&#39;N_MEASUREMENTS&#39;], np.zeros(ds.dims[&#39;N_MEASUREMENTS&#39;], dtype=int))
/home/runner/work/seagliderOG1/seagliderOG1/seagliderOG1/tools.py:292: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  ds[&#39;DEPTH_Z&#39;] = ([&#39;N_MEASUREMENTS&#39;], np.full(ds.dims[&#39;N_MEASUREMENTS&#39;], np.nan))
</pre></div></div>
</div>
</section>
</section>
<section id="Saving-data">
<h2>Saving data<a class="headerlink" href="#Saving-data" title="Link to this heading"></a></h2>
<p>Due to problems with writing <code class="docutils literal notranslate"><span class="pre">xarray</span></code> datasets as netCDF when attributes are not of a specified type (<code class="docutils literal notranslate"><span class="pre">str</span></code>, <code class="docutils literal notranslate"><span class="pre">Number</span></code>, <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code>, <code class="docutils literal notranslate"><span class="pre">np.number</span></code>, <code class="docutils literal notranslate"><span class="pre">list</span></code>, <code class="docutils literal notranslate"><span class="pre">tuple</span></code>), a function was written <code class="docutils literal notranslate"><span class="pre">save_dataset</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write the file</span>
<span class="c1"># This writer catches errors in data types (DType errors) when using xr.to_netcdf()</span>
<span class="c1"># The solution is to convert them to strings, which may be undesired behaviour</span>
<span class="n">output_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="s1">&#39;demo_test.nc&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output_file</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>

<span class="n">writers</span><span class="o">.</span><span class="n">save_dataset</span><span class="p">(</span><span class="n">ds_OG1</span><span class="p">,</span> <span class="n">output_file</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
TypeError Invalid value for attr &#39;calibration_parameters&#39;: {&#39;t_g&#39;: 0.00431040083, &#39;t_h&#39;: 0.000631750336, &#39;t_i&#39;: 2.27137914e-05, &#39;t_j&#39;: 2.20168797e-06, &#39;c_g&#39;: -10.2690994, &#39;c_h&#39;: 1.1547191, &#39;c_i&#39;: -0.00143967206, &#39;c_j&#39;: 0.000204972837, &#39;cpcor&#39;: -9.57e-08, &#39;ctcor&#39;: 3.25e-06}. For serialization to netCDF files, its value must be of one of the following types: str, Number, ndarray, number, list, tuple, bytes
variable &#39;SENSOR_CTD_UNKNOWN&#39;: Converting attribute &#39;calibration_parameters&#39; with value &#39;{&#39;t_g&#39;: 0.00431040083, &#39;t_h&#39;: 0.000631750336, &#39;t_i&#39;: 2.27137914e-05, &#39;t_j&#39;: 2.20168797e-06, &#39;c_g&#39;: -10.2690994, &#39;c_h&#39;: 1.1547191, &#39;c_i&#39;: -0.00143967206, &#39;c_j&#39;: 0.000204972837, &#39;cpcor&#39;: -9.57e-08, &#39;ctcor&#39;: 3.25e-06}&#39; to string.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the data saved</span>
<span class="n">ds1</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>

<span class="c1"># Generate a simple plot</span>
<span class="c1">#plotters.show_contents(ds_all,&#39;attrs&#39;)</span>
<span class="n">plotters</span><span class="o">.</span><span class="n">plot_depth_colored</span><span class="p">(</span><span class="n">ds1</span><span class="p">,</span> <span class="n">color_by</span><span class="o">=</span><span class="s1">&#39;PROFILE_NUMBER&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/demo-output_21_0.png" src="_images/demo-output_21_0.png" />
</div>
</div>
</section>
<section id="Run-multiple-missions">
<h2>Run multiple missions<a class="headerlink" href="#Run-multiple-missions" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add these to existing attributes - update to your details</span>
<span class="n">contrib_to_append</span> <span class="o">=</span> <span class="n">vocabularies</span><span class="o">.</span><span class="n">contrib_to_append</span>
<span class="nb">print</span><span class="p">(</span><span class="n">contrib_to_append</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;contributor_name&#39;: &#39;Eleanor Frajka-Williams&#39;, &#39;contributor_email&#39;: &#39;eleanorfrajka@gmail.com&#39;, &#39;contributor_role&#39;: &#39;Data scientist&#39;, &#39;contributor_role_vocabulary&#39;: &#39;http://vocab.nerc.ac.uk/search_nvs/W08&#39;, &#39;contributing_institutions&#39;: &#39;University of Hamburg - Institute of Oceanography&#39;, &#39;contributing_institutions_vocabulary&#39;: &#39;https://edmo.seadatanet.org/report/1156&#39;, &#39;contributing_institutions_role&#39;: &#39;Data scientist&#39;, &#39;contributing_institutions_role_vocabulary&#39;: &#39;http://vocab.nerc.ac.uk/search_nvs/W08&#39;}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify a list of servers or local directories</span>
<span class="n">input_locations</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># Either Iceland, Faroes or RAPID/MOCHA</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/005/20090829/&quot;, # done</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/005/20080606/&quot;, # done</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/005/20081106/&quot;, # done</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/012/20070831/&quot;, # done</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/014/20080214/&quot;,  # done</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/014/20080222/&quot;, # done</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/016/20061112/&quot;,  # done</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/016/20090605/&quot;, # done</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/016/20071113/&quot;, # done</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/016/20080607/&quot;,  # done</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/033/20100518/&quot;, # done</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/033/20100903/&quot;, # done</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/101/20081108/&quot;,     # done</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/101/20061112/&quot;,    # done</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/101/20070609/&quot;,   # done</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/102/20061112/&quot;,  # done</span>
    <span class="c1"># Labrador Sea</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/015/20040924/&quot;,</span>
    <span class="s2">&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/014/20040924/&quot;</span><span class="p">,</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/008/20031002/&quot;,</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/004/20031002/&quot;,</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/016/20050406/&quot;,</span>
    <span class="c1"># RAPID/MOCHA</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/033/20100729/&quot;,</span>
    <span class="c1">#&quot;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/034/20110128/&quot;,</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">input_loc</span> <span class="ow">in</span> <span class="n">input_locations</span><span class="p">:</span>
    <span class="c1"># Example usage</span>
    <span class="n">ds_all</span> <span class="o">=</span> <span class="n">convertOG1</span><span class="o">.</span><span class="n">process_and_save_data</span><span class="p">(</span><span class="n">input_loc</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">data_path</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">run_quietly</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Downloading file &#39;p0140001_20040924.nc&#39; from &#39;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/015/20040924/p0140001_20040924.nc&#39; to &#39;/home/runner/.cache/seagliderOG1&#39;.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">HTTPError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[14], line 33</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> input_locations <span style="color: rgb(98,98,98)">=</span> [
<span class="ansi-green-intense-fg ansi-bold">      3</span>     <span style="color: rgb(95,135,135)"># Either Iceland, Faroes or RAPID/MOCHA</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span>     <span style="color: rgb(95,135,135)">#&#34;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/005/20090829/&#34;, # done</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">     28</span>     <span style="color: rgb(95,135,135)">#&#34;https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/034/20110128/&#34;,</span>
<span class="ansi-green-intense-fg ansi-bold">     29</span> ]
<span class="ansi-green-intense-fg ansi-bold">     31</span> <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> input_loc <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> input_locations:
<span class="ansi-green-intense-fg ansi-bold">     32</span>     <span style="color: rgb(95,135,135)"># Example usage</span>
<span class="ansi-green-fg">---&gt; 33</span>     ds_all <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">convertOG1</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">process_and_save_data</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">input_loc</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">output_dir</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">data_path</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">save</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">True</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg">  </span><span class="ansi-yellow-bg">run_quietly</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">True</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/work/seagliderOG1/seagliderOG1/seagliderOG1/convertOG1.py:608</span>, in <span class="ansi-cyan-fg">process_and_save_data</span><span class="ansi-blue-fg">(input_location, save, output_dir, run_quietly)</span>
<span class="ansi-green-intense-fg ansi-bold">    592</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    593</span> <span style="color: rgb(175,0,0)">Processes and saves data from the specified input location.</span>
<span class="ansi-green-intense-fg ansi-bold">    594</span> <span style="color: rgb(175,0,0)">This function loads and concatenates datasets from the server, converts them to OG1 format,</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    604</span> <span style="color: rgb(175,0,0)">xarray.Dataset: The processed dataset.</span>
<span class="ansi-green-intense-fg ansi-bold">    605</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    607</span> <span style="color: rgb(95,135,135)"># Load and concatenate all datasets from the server</span>
<span class="ansi-green-fg">--&gt; 608</span> list_datasets <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">readers</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">read_basestation</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">input_location</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    610</span> <span style="color: rgb(95,135,135)"># Convert the list of datasets to OG1</span>
<span class="ansi-green-intense-fg ansi-bold">    611</span> ds1 <span style="color: rgb(98,98,98)">=</span> convert_to_OG1(list_datasets[<span style="color: rgb(98,98,98)">-</span><span style="color: rgb(98,98,98)">1</span>])

File <span class="ansi-green-fg">~/work/seagliderOG1/seagliderOG1/seagliderOG1/readers.py:109</span>, in <span class="ansi-cyan-fg">read_basestation</span><span class="ansi-blue-fg">(source, start_profile, end_profile)</span>
<span class="ansi-green-intense-fg ansi-bold">    107</span> <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> file <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> filtered_files:
<span class="ansi-green-intense-fg ansi-bold">    108</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> source<span style="color: rgb(98,98,98)">.</span>startswith(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">http://</span><span style="color: rgb(175,0,0)">&#34;</span>) <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> source<span style="color: rgb(98,98,98)">.</span>startswith(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">https://</span><span style="color: rgb(175,0,0)">&#34;</span>):
<span class="ansi-green-fg">--&gt; 109</span>         ds <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">load_sample_dataset</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">file</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    110</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">    111</span>         ds <span style="color: rgb(98,98,98)">=</span> xr<span style="color: rgb(98,98,98)">.</span>open_dataset(os<span style="color: rgb(98,98,98)">.</span>path<span style="color: rgb(98,98,98)">.</span>join(source, file))

File <span class="ansi-green-fg">~/work/seagliderOG1/seagliderOG1/seagliderOG1/readers.py:37</span>, in <span class="ansi-cyan-fg">load_sample_dataset</span><span class="ansi-blue-fg">(dataset_name)</span>
<span class="ansi-green-intense-fg ansi-bold">     35</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span><span style="color: rgb(188,188,188)"> </span><span style="color: rgb(0,0,255)">load_sample_dataset</span>(dataset_name<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">p0040034_20031007.nc</span><span style="color: rgb(175,0,0)">&#34;</span>):
<span class="ansi-green-intense-fg ansi-bold">     36</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> dataset_name <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> data_source_og<span style="color: rgb(98,98,98)">.</span>registry<span style="color: rgb(98,98,98)">.</span>keys():
<span class="ansi-green-fg">---&gt; 37</span>         file_path <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">data_source_og</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fetch</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">dataset_name</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     38</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> xr<span style="color: rgb(98,98,98)">.</span>open_dataset(file_path)
<span class="ansi-green-intense-fg ansi-bold">     39</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:

File <span class="ansi-green-fg">~/micromamba/envs/TEST/lib/python3.12/site-packages/pooch/core.py:589</span>, in <span class="ansi-cyan-fg">Pooch.fetch</span><span class="ansi-blue-fg">(self, fname, processor, downloader, progressbar)</span>
<span class="ansi-green-intense-fg ansi-bold">    586</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> downloader <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">    587</span>         downloader <span style="color: rgb(98,98,98)">=</span> choose_downloader(url, progressbar<span style="color: rgb(98,98,98)">=</span>progressbar)
<span class="ansi-green-fg">--&gt; 589</span>     <span class="ansi-yellow-bg">stream_download</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    590</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">url</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    591</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">full_path</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    592</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">known_hash</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    593</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">downloader</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    594</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">pooch</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    595</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">retry_if_failed</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">retry_if_failed</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    596</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    598</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> processor <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">    599</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> processor(<span style="color: rgb(0,135,0)">str</span>(full_path), action, <span style="color: rgb(0,135,0)">self</span>)

File <span class="ansi-green-fg">~/micromamba/envs/TEST/lib/python3.12/site-packages/pooch/core.py:807</span>, in <span class="ansi-cyan-fg">stream_download</span><span class="ansi-blue-fg">(url, fname, known_hash, downloader, pooch, retry_if_failed)</span>
<span class="ansi-green-intense-fg ansi-bold">    803</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-intense-fg ansi-bold">    804</span>     <span style="color: rgb(95,135,135)"># Stream the file to a temporary so that we can safely check its</span>
<span class="ansi-green-intense-fg ansi-bold">    805</span>     <span style="color: rgb(95,135,135)"># hash before overwriting the original.</span>
<span class="ansi-green-intense-fg ansi-bold">    806</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> temporary_file(path<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(0,135,0)">str</span>(fname<span style="color: rgb(98,98,98)">.</span>parent)) <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> tmp:
<span class="ansi-green-fg">--&gt; 807</span>         <span class="ansi-yellow-bg">downloader</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">url</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">tmp</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">pooch</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    808</span>         hash_matches(tmp, known_hash, strict<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">True</span>, source<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(0,135,0)">str</span>(fname<span style="color: rgb(98,98,98)">.</span>name))
<span class="ansi-green-intense-fg ansi-bold">    809</span>         shutil<span style="color: rgb(98,98,98)">.</span>move(tmp, <span style="color: rgb(0,135,0)">str</span>(fname))

File <span class="ansi-green-fg">~/micromamba/envs/TEST/lib/python3.12/site-packages/pooch/downloaders.py:221</span>, in <span class="ansi-cyan-fg">HTTPDownloader.__call__</span><span class="ansi-blue-fg">(self, url, output_file, pooch, check_only)</span>
<span class="ansi-green-intense-fg ansi-bold">    219</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-intense-fg ansi-bold">    220</span>     response <span style="color: rgb(98,98,98)">=</span> requests<span style="color: rgb(98,98,98)">.</span>get(url, timeout<span style="color: rgb(98,98,98)">=</span>timeout, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs)
<span class="ansi-green-fg">--&gt; 221</span>     <span class="ansi-yellow-bg">response</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">raise_for_status</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    222</span>     content <span style="color: rgb(98,98,98)">=</span> response<span style="color: rgb(98,98,98)">.</span>iter_content(chunk_size<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>chunk_size)
<span class="ansi-green-intense-fg ansi-bold">    223</span>     total <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">int</span>(response<span style="color: rgb(98,98,98)">.</span>headers<span style="color: rgb(98,98,98)">.</span>get(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">content-length</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(98,98,98)">0</span>))

File <span class="ansi-green-fg">~/micromamba/envs/TEST/lib/python3.12/site-packages/requests/models.py:1024</span>, in <span class="ansi-cyan-fg">Response.raise_for_status</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">   1019</span>     http_error_msg <span style="color: rgb(98,98,98)">=</span> (
<span class="ansi-green-intense-fg ansi-bold">   1020</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>status_code<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> Server Error: </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>reason<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> for url: </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>url<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   1021</span>     )
<span class="ansi-green-intense-fg ansi-bold">   1023</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> http_error_msg:
<span class="ansi-green-fg">-&gt; 1024</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> HTTPError(http_error_msg, response<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(0,135,0)">self</span>)

<span class="ansi-red-fg">HTTPError</span>: 404 Client Error: Not Found for url: https://www.ncei.noaa.gov/data/oceans/glider/seaglider/uw/015/20040924/p0140001_20040924.nc
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to seagliderOG1’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="seagliderOG1.html" class="btn btn-neutral float-right" title="seagliderOG1 API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Eleanor Frajka-Williams.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>